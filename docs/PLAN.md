# Roadmap: Projects & Finance

## Правила
- Каждый этап с пометкой **HARD GATE** завершается зелёной сборкой Vercel и фиксацией артефактов.
- Незавершённые фичи изолируются за фич-флагами или заглушками, чтобы основная ветка оставалась стабильной.
- Роли и ACL повторяются в UI и API; аудит и телеметрия действий включены на всех продуктивных маршрутах.
- Экспорт/импорт данных проверяется перед включением этапа, форматы дат и денег соответствуют локали воркспейса.

## Этапы
- 0) Post-B0 — ✅ done @ HEAD
- 1) F2-STAB — Расходы — ⏳ queued
- 2) P2 — Обзор проектов — ⏳ queued
- 3) P3 — Мастер создания — ⏳ queued
- 4) P4 — Обзор проекта — ⏳ queued
- 5) F3 — Бюджет/лимиты — ⏳ queued
- 6) P5-MVP — Задачи — ⏳ queued
- 7) P6 — Итерации/burndown — ⏳ queued
- 8) F4 — Автоматизации — ⏳ queued

## Definition of Done
### Этап 0. Post-B0
- [x] Разрешены конфликты и выровнена структура маршрутов «Проекты» и «Финансы».
- [x] Согласован набор фич-флагов 2-го поколения и обновлён `.env.example`.
- [x] Незавершённые страницы исключены из сборки либо закрыты заглушками.
- [x] Зелёная сборка Vercel подтверждена.

### Этап 1. F2-STAB — Расходы
- [ ] Нормализованы данные расходов (вложения, поставщик, проект) на уровне адаптеров и UI.
- [ ] CSV-импорт выполняет предвалидацию строк, формирует отчёт об ошибках и создаёт черновики безопасно.
- [ ] Настроена двусторонняя синхронизация с «Финансами проекта» и соблюдены роли на UI.
- [ ] Включены только стабильные публичные маршруты, незавершённое закрыто за фич-флагом.
- [ ] Зелёная сборка Vercel и включение раздела по умолчанию подтверждены (**HARD GATE**).

### Этап 2. P2 — Обзор проектов
- [ ] Реализованы табы «Мои»/«Я участник», поиск, фильтры, сортировки и карточки с метриками.
- [ ] Состояние страницы синхронизируется с URL, поддержаны пустые состояния, skeleton и кэширование запросов.
- [ ] Настроена виртуализация длинных списков и быстрые действия с учётом ролей.
- [ ] Этап включён по умолчанию и подтверждён зелёной сборкой Vercel (**HARD GATE**).

### Этап 3. P3 — Мастер создания
- [ ] Мастер включает шаг выбора шаблона, шаг данных и шаг команды с приглашениями.
- [ ] Черновик хранится в `sessionStorage`, добавлены валидации и редирект в созданный проект.
- [ ] Подготовлена точка интеграции с «Документами» и задействован общий drawer.
- [ ] Этап включён по умолчанию и подтверждён зелёной сборкой Vercel (**HARD GATE**).

### Этап 4. P4 — Обзор проекта
- [ ] Добавлены виджеты «Сегодня», «Прогресс», «Сроки и риски», «Активность», «Подсказки» с переходами в разделы.
- [ ] Реализованы пустые состояния и телеметрия просмотров и кликов.
- [ ] Этап включён по умолчанию и подтверждён зелёной сборкой Vercel (**HARD GATE**).

### Этап 5. F3 — Бюджет/лимиты
- [ ] Реализован экран настроек бюджета (валюта, общий лимит, порог, лимиты по категориям).
- [ ] Добавлен виджет «Бюджет/Расходы» и баннеры при превышении лимитов, авто-pending новых трат.
- [ ] Пересчитываются агрегаты при смене статусов расходов и синхронизируется UI.
- [ ] Этап включён по умолчанию и подтверждён зелёной сборкой Vercel (**HARD GATE**).

### Этап 6. P5-MVP — Задачи
- [ ] Список задач поддерживает фильтры, массовые действия и синхронизацию с URL.
- [ ] Канбан реализует drag-and-drop стадий и использует универсальный drawer карточки задачи.
- [ ] Поддержаны пустые состояния, кеширование и роли, этап включён по умолчанию с зелёной сборкой Vercel (**HARD GATE**).

### Этап 7. P6 — Итерации/burndown
- [ ] Добавлен CRUD итераций с привязкой задач и календарным отображением.
- [ ] Построена диаграмма burndown и фильтры по итерациям в задачах и аналитике.
- [ ] Этап включён по умолчанию и подтверждён зелёной сборкой Vercel (**HARD GATE**).

### Этап 8. F4 — Автоматизации
- [ ] Реализована кнопка «Создать трату» в карточках задач/файлов с автоконтекстом проекта.
- [ ] Добавлено правило «трата превышает лимит → уведомить и перевести в согласование» и журнал срабатываний.
- [ ] Этап включён по умолчанию и подтверждён зелёной сборкой Vercel (**HARD GATE**).

## Артефакты в PR
- Summary с ключевыми изменениями.
- Скриншоты основных экранов и диалогов.
- Лог успешной сборки Vercel.
- Перечень активных фич-флагов.
- E2E-репорт (GitHub Actions или локальный).
