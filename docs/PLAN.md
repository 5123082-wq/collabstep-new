# Roadmap: Projects & Finance

> **Статус:** Перезапуск — все этапы обнулены  
> **Последнее обновление:** 2025-11-04

## Правила разработки

- Каждый этап с пометкой **HARD GATE** завершается зелёной сборкой Vercel и фиксацией артефактов.
- Незавершённые фичи изолируются за фич-флагами или заглушками, чтобы основная ветка оставалась стабильной.
- Роли и ACL повторяются в UI и API; аудит и телеметрия действий включены на всех продуктивных маршрутах.
- Экспорт/импорт данных проверяется перед включением этапа, форматы дат и денег соответствуют локали воркспейса.

## Этапы (обнулены для перезапуска)

- 0) Базовая инфраструктура — ✅ завершён
- 1) F2-STAB — Расходы — ⏳ в очереди
- 2) P2 — Обзор проектов — ⏳ в очереди
- 3) P3 — Мастер создания — ⏳ в очереди
- 4) P4 — Обзор проекта — ⏳ в очереди
- 5) F3 — Бюджет/лимиты — ⏳ в очереди
- 6) P5-MVP — Задачи — ⏳ в очереди
- 7) P6 — Итерации/burndown — ⏳ в очереди
- 8) F4 — Автоматизации — ⏳ в очереди

## Project Management — План внедрения

### Этапы (Project Management)
- 0) PM0 — Актуализация требований и архитектуры — ⏳ в очереди
- 1) PM1 — Workspaces & Projects — ⏳ в очереди
- 2) PM2 — Управление задачами и иерархией — ⏳ в очереди
- 3) PM3 — Коллаборация и файловые артефакты — ⏳ в очереди
- 4) PM4 — Тайм-менеджмент и аудит — ⏳ в очереди
- 5) PM5 — Дифференциаторы AI/маркетплейс — ⏳ в очереди
- 6) PM6 — Stabilization & Launch — ⏳ в очереди

### Этап PM0. Актуализация требований и архитектуры
- [ ] Сверить выданное ТЗ с текущей дорожной картой Project Management и оформить фазы включения фич-флагов и HARD GATE-критерии.
- [ ] Провести ревью существующих API и доменной модели проектов/задач, подготовить список расширений для ролей workspace, файловых связей и аудит-трека.
- [ ] Согласовать артефакты Stage 0: архитектурную диаграмму и план миграций, обновить карту интеграций с соседними блоками.

### Этап PM1. Workspaces & Projects
- [ ] Расширить API проектов и шаблонов: CRUD рабочих пространств, роли Owner/Admin/Member/Viewer, приватность, типы проектов, бюджет и дедлайн.
- [ ] Переработать мастер создания проектов с новыми полями и привязкой к ролям.
- [ ] Обновить модели `accounts`, `org_members`, `project_members` под мультиаккаунт и провести ревью ACL.

### Этап PM2. Управление задачами и иерархией
- [ ] Обновить task API под иерархию «Эпики → Задачи → Подзадачи» с неограниченной вложенностью.
- [ ] Реализовать представления: Канбан, Список, Gantt (Timeline), Календарь и Таблица с общим состоянием и drag & drop сменой статусов.
- [ ] Обновить карточку задачи, чек-листы, вложения, связи и time tracking (estimate/spent).

### Этап PM3. Коллаборация и файловые артефакты
- [ ] Настроить единый сервис вложений с версиями и связями задач/комментариев.
- [ ] Добавить тредовые комментарии с Markdown и упоминаниями, обеспечить drag & drop загрузку.
- [ ] Включить аудит-трек изменений и интеграцию с уведомлениями.

### Этап PM4. Тайм-менеджмент и аудит
- [ ] Внедрить план/факт трекинг времени и соответствующие UI-виджеты.
- [ ] Реализовать историю изменений с фильтрами по событиям и синхронизацию с уведомлениями.
- [ ] Подготовить отчёты и метрики для прогнозов рисков срыва дедлайнов.

### Этап PM5. Дифференциаторы AI/маркетплейс
- [ ] AI-генерация структуры проектов: промпт-пайплайн, мастер создания, ручное редактирование и сохранение.
- [ ] Маркетплейс шаблонов и блоков: покупка, one-click развёртывание и связывание с текущими проектами.
- [ ] Predictive analytics и публичные проекты: прогноз рисков, публикация портфолио и интеграция с community/marketing.

### Этап PM6. Stabilization & Launch
- [ ] Регрессионное и интеграционное тестирование, сбор метрик и подготовка обучающих материалов.
- [ ] Проверка фич-флагов, релизных заметок и Vercel build перед общедоступным запуском.
- [ ] Консолидированный отчёт по внедрению Project Management блока.

## Definition of Done

> Все этапы обнулены. Чек-листы будут обновляться по мере прогресса.

### Этап 0. Базовая инфраструктура
- [x] Разрешены конфликты и выровнена структура маршрутов.
- [x] Согласован набор фич-флагов и обновлён `.env.example`.
- [x] Незавершённые страницы исключены из сборки либо закрыты заглушками.
- [x] Зелёная сборка Vercel подтверждена.

### Этап 1. F2-STAB — Расходы
- [ ] Нормализованы данные расходов (вложения, поставщик, проект) на уровне адаптеров и UI.
- [ ] CSV-импорт выполняет предвалидацию строк, формирует отчёт об ошибках и создаёт черновики безопасно.
- [ ] Настроена двусторонняя синхронизация с «Финансами проекта» и соблюдены роли на UI.
- [ ] Включены только стабильные публичные маршруты, незавершённое закрыто за фич-флагом.
- [ ] Зелёная сборка Vercel и включение раздела по умолчанию подтверждены (**HARD GATE**).

### Этап 2. P2 — Обзор проектов
- [ ] Реализованы табы «Мои»/«Я участник», поиск, фильтры, сортировки и карточки с метриками.
- [ ] Состояние страницы синхронизируется с URL, поддержаны пустые состояния, skeleton и кэширование запросов.
- [ ] Настроена виртуализация длинных списков и быстрые действия с учётом ролей.
- [ ] Этап включён по умолчанию и подтверждён зелёной сборкой Vercel (**HARD GATE**).

### Этап 3. P3 — Мастер создания
- [ ] Мастер включает шаг выбора шаблона, шаг данных и шаг команды с приглашениями.
- [ ] Черновик хранится в `sessionStorage`, добавлены валидации и редирект в созданный проект.
- [ ] Подготовлена точка интеграции с «Документами» и задействован общий drawer.
- [ ] Этап включён по умолчанию и подтверждён зелёной сборкой Vercel (**HARD GATE**).

### Этап 4. P4 — Обзор проекта
- [ ] Добавлены виджеты «Сегодня», «Прогресс», «Сроки и риски», «Активность», «Подсказки» с переходами в разделы.
- [ ] Реализованы пустые состояния и телеметрия просмотров и кликов.
- [ ] Этап включён по умолчанию и подтверждён зелёной сборкой Vercel (**HARD GATE**).

### Этап 5. F3 — Бюджет/лимиты
- [ ] Реализован экран настроек бюджета (валюта, общий лимит, порог, лимиты по категориям).
- [ ] Добавлен виджет «Бюджет/Расходы» и баннеры при превышении лимитов, авто-pending новых трат.
- [ ] Пересчитываются агрегаты при смене статусов расходов и синхронизируется UI.
- [ ] Этап включён по умолчанию и подтверждён зелёной сборкой Vercel (**HARD GATE**).

### Этап 6. P5-MVP — Задачи
- [ ] Список задач поддерживает фильтры, массовые действия и синхронизацию с URL.
- [ ] Канбан реализует drag-and-drop стадий и использует универсальный drawer карточки задачи.
- [ ] Поддержаны пустые состояния, кеширование и роли, этап включён по умолчанию с зелёной сборкой Vercel (**HARD GATE**).

### Этап 7. P6 — Итерации/burndown
- [ ] Добавлен CRUD итераций с привязкой задач и календарным отображением.
- [ ] Построена диаграмма burndown и фильтры по итерациям в задачах и аналитике.
- [ ] Этап включён по умолчанию и подтверждён зелёной сборкой Vercel (**HARD GATE**).

### Этап 8. F4 — Автоматизации
- [ ] Реализована кнопка «Создать трату» в карточках задач/файлов с автоконтекстом проекта.
- [ ] Добавлено правило «трата превышает лимит → уведомить и перевести в согласование» и журнал срабатываний.
- [ ] Этап включён по умолчанию и подтверждён зелёной сборкой Vercel (**HARD GATE**).

## Артефакты в PR
- Summary с ключевыми изменениями.
- Скриншоты основных экранов и диалогов.
- Лог успешной сборки Vercel.
- Перечень активных фич-флагов.
- E2E-репорт (GitHub Actions или локальный).
